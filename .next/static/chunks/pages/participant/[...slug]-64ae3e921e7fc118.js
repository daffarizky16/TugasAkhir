(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[212],{4443:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/participant/[...slug]",function(){return n(1933)}])},1206:function(e,t,n){"use strict";n.d(t,{w:function(){return c}});var i=n(5893),s=n(7294),a=n(570),l=n(745);function r(e){var t=(0,s.useState)(e.isOpen),n=t[0],l=t[1];return(0,i.jsxs)("div",{className:"relative z-10 ".concat(!n&&"hidden"),"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[(0,i.jsx)("div",{className:"fixed inset-0 bg-zinc-900 bg-opacity-40 transition-opacity"}),(0,i.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,i.jsx)("div",{className:"flex min-h-full items-end justify-center text-center sm:items-center sm:p-0",children:(0,i.jsx)("div",{className:"relative transform overflow-hidden bg-white text-left shadow-xl transition-all p-4 rounded-md",children:(0,i.jsxs)("div",{className:"w-full p-5 text-center",children:[(0,i.jsx)("p",{className:"text-2xl font-bold",children:e.title||"Title"}),(0,i.jsx)("p",{className:"text-lg",children:e.subtitle||"Sub Title"}),(0,i.jsxs)("div",{className:"space-x-3 mt-5",children:[(0,i.jsx)("button",{className:"text-sm bg-zinc-100 px-2 py-1 hover:bg-zinc-200",onClick:function(){e.onNegativeClick,l(!1)},children:e.negativeText||"Kembali"}),(0,i.jsx)(a.Z,{className:"".concat(!e.onPositiveClick&&"hidden"),onClick:function(){e.onPositiveClick&&e.onPositiveClick(),l(!1)},size:"sm",text:e.positiveText||"Ya"})]})]})})})})]})}function c(e){var t=document.createElement("div");t.id="alert",document.body.appendChild(t),(0,l.createRoot)(t).render((0,i.jsx)(r,{isOpen:!0,title:e.title,subtitle:e.subtitle,positiveText:e.positiveText,negativeText:e.negativeText,onPositiveClick:e.onPositiveClick,onNegativeClick:e.onNegativeClick}))}},570:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(5893);function s(e){return(0,i.jsx)("button",{disabled:e.isLoading,onClick:function(t){t.preventDefault(),e.onClick()},className:"bg-sky-500 text-white  hover:bg-sky-400 font-bold rounded-md  \n      ".concat(e.className," ").concat("sm"===e.size?"py-1 px-2 text-sm ":"lg"===e.size?"py-3 px-4":"py-2 px-3"),children:e.isLoading?"Loading...":e.text})}},2825:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var i=n(5893),s=n(1664),a=n.n(s),l=n(3299),r=n(570);function c(){var e=(0,l.useSession)().data;return(0,i.jsxs)("div",{className:"flex justify-between py-3 container mx-auto",children:[(0,i.jsx)(a(),{href:"/",children:(0,i.jsx)("a",{className:"font-bold text-2xl",children:"Voting-Ku"})}),e?(0,i.jsxs)("div",{className:"space-x-3",children:[(0,i.jsx)("span",{children:e.user.name}),(0,i.jsx)(r.Z,{onClick:l.signOut,text:"Logout"})]}):(0,i.jsx)(r.Z,{onClick:l.signIn,text:"Login"})]})}},2670:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(5893),s=n(3299),a=n(9008),l=n.n(a),r=n(5675),c=n.n(r),o=n(570);function d(){return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen space-y-5",children:[(0,i.jsx)(l(),{children:(0,i.jsx)("title",{children:"Login"})}),(0,i.jsx)(c(),{src:"/images/yah.png",alt:"thinking",width:200,height:200}),(0,i.jsx)("h1",{className:"text-4xl font-bold",children:"Login Dulu Ya!"}),(0,i.jsx)("h2",{children:"Untuk mengakses halaman ini, kamu wajib login terlebih dahulu"}),(0,i.jsx)(o.Z,{onClick:s.signIn,text:"Login",size:"lg"})]})}},2685:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(8100);function s(e){var t=function(e){return fetch(e).then(function(e){return e.json()})},n=(0,i.ZP)("/api/votes/"+e,t),s=n.data,a=n.mutate,l=n.error;return{vote:null==s?void 0:s.data,isLoading:!l&&!s,mutate:a,isError:l}}},1933:function(e,t,n){"use strict";n.r(t),n.d(t,{STATE_ENDED:function(){return _},STATE_LOADING:function(){return E},STATE_NOT_STARTED:function(){return w},STATE_STARTED:function(){return S},default:function(){return C}});var i=n(7568),s=n(655),a=n(5893),l=n(381),r=n.n(l),c=n(3299),o=n(9008),d=n.n(o),u=n(1163),x=n(7294),m=n(1206),v=n(570),h=n(2536);function f(e){return(0,a.jsxs)("div",{className:"flex flex-row border border-zinc-100 p-5 rounded-md space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 font-bold text-lg items-center flex justify-center bg-zinc-100 text-center",children:e.index}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("p",{className:"text-lg font-bold",children:e.name}),(0,a.jsx)("p",{children:e.title}),(0,a.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-full h-1 bg-zinc-100 rounded-md",children:(0,a.jsx)("div",{className:"h-1 bg-zinc-800 rounded-md",style:{width:"".concat(e.percentage,"%")}})}),(0,a.jsxs)("p",{className:"text-sm font-bold",children:[Intl.NumberFormat("en",{notation:"compact"}).format(e.percentage||0),"%"]})]})]}),(0,a.jsx)("div",{onClick:e.onClick,className:"flex w-20 aspect-square rounded-md items-center justify-center cursor-pointer ".concat(e.isSelected?"bg-green-500 hover:bg-green-600 text-white":"bg-zinc-100 hover:bg-zinc-200 "),children:(0,a.jsx)("span",{children:(0,a.jsx)(h.Z,{className:"w-7 h-7"})})})]})}var p=n(8130),g=function(e){var t=e.label,n=e.value;return(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"flex flex-col text-center",children:[(0,a.jsx)("span",{className:"text-5xl font-bold",children:(0,p.Bu)(n,2)}),(0,a.jsx)("span",{className:"font-light text-xl",children:t})]}),"Detik"!==t&&(0,a.jsx)("span",{className:"mx-5 text-4xl",children:":"})]})},j=function(e){return(0,a.jsxs)("div",{className:"flex flex-row mx-auto justify-center",children:[e.days>0&&(0,a.jsx)(g,{label:"Hari",value:e.days}),e.hours>0&&(0,a.jsx)(g,{label:"Jam",value:e.hours}),e.minutes>0&&(0,a.jsx)(g,{label:"Menit",value:e.minutes}),(0,a.jsx)(g,{label:"Detik",value:e.seconds})]})};function b(e){var t=function(e){var t=e.days,n=e.hours,i=e.minutes,s=e.seconds;return e.completed,(0,a.jsx)(j,{days:t,hours:n,minutes:i,seconds:s})};return(0,a.jsxs)("div",{className:" mt-10 text-center",children:[e.currentState===E&&(0,a.jsx)(a.Fragment,{children:"Tunggu Sebentar..."}),e.currentState===w&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Voting Akan Dimulai pada : "}),(0,a.jsx)(p.ZP,{date:e.start,renderer:t})]}),e.currentState===_&&(0,a.jsx)("span",{className:"bg-zinc-100 px-3 py-1 font-medium text-lg",children:"Voting Telah Berakhir"}),e.currentState===S&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:"Voting Sedang Berlangsung :"}),(0,a.jsx)(p.ZP,{date:e.end,renderer:t})]})]})}var N=n(2825),k=n(2670),T=n(8100),y=n(2685),w="STATE_NOT_STARTED",S="STATE_STARTED",_="STATE_ENDED",E="STATE_LOADING";function C(){var e,t,n,l,o,h,p,g,j,C=(0,c.useSession)().data,D=(0,u.useRouter)().query.slug,Z=(0,y.Z)(D),z=Z.vote,A=Z.mutate,L=Z.isLoading,P=(o=function(e){return fetch(e).then(function(e){return e.json()})},p=(h=(0,T.ZP)("/api/participant/"+D,o)).data,g=h.error,j=h.mutate,{data:null==p?void 0:p.data,mutate:j,isLoading:!g&&!p,isError:g}),O=P.data,V=P.mutate,I=P.isLoading;P.isError;var K,R=(0,x.useState)(null),B=R[0],G=R[1],Y=(0,x.useState)(E),q=Y[0],F=Y[1],J=(K=(0,i.Z)(function(){return(0,s.__generator)(this,function(e){return B?(0,m.w)({title:"Kamu yakin?",subtitle:"Kamu akan memilih "+B.name,positiveText:"Ya, saya yakin",negativeText:"Tidak",onPositiveClick:(0,i.Z)(function(){var e,t;return(0,s.__generator)(this,function(t){switch(t.label){case 0:return[4,fetch("/api/participant/"+(null==z?void 0:z.code),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidate:B.name,email:null==C?void 0:null===(e=C.user)||void 0===e?void 0:e.email})})];case 1:return 200===t.sent().status&&(V(),A(),(0,m.w)({title:"Vote Terkirim",subtitle:"terima kasih telah berpartisipasi"})),[2]}})})}):(0,m.w)({title:"Vote Gagal ‚ùå",subtitle:"Pilih salah satu kandidat"}),[2]})}),function(){return K.apply(this,arguments)});return((0,x.useEffect)(function(){if(z&&q!==_){var e=r()(null==z?void 0:z.startDateTime),t=r()(null==z?void 0:z.endDateTime),n=setInterval((0,i.Z)(function(){var n;return(0,s.__generator)(this,function(i){return(n=r()()).isBefore(e)?F(w):n.isAfter(e)&&n.isBefore(t)?F(S):n.isAfter(t)&&F(_),[2]})}),1e3);return function(){return clearInterval(n)}}},[z]),(0,x.useEffect)(function(){if(z&&O){var e,t=null==z?void 0:null===(e=z.candidates)||void 0===e?void 0:e.find(function(e){return e.name===(null==O?void 0:O.candidate)});t&&G(t)}},[O,z]),C)?(0,a.jsxs)("div",{className:"mb-10 ".concat(L&&"animate-pulse"),children:[(0,a.jsx)(d(),{children:(0,a.jsx)("title",{children:"Mulai Voting"})}),(0,a.jsx)(N.Z,{}),(0,a.jsxs)("div",{className:"container mx-auto",children:[(0,a.jsx)("h1",{className:"text-4xl mt-10 text-center",children:null==z?void 0:z.title}),(null==z?void 0:z.startDateTime)&&(null==z?void 0:z.endDateTime)&&(0,a.jsx)(b,{start:null==z?void 0:z.startDateTime,end:null==z?void 0:z.endDateTime,currentState:q}),(0,a.jsx)("div",{className:"lg:p-5 mt-10 space-y-3 w-full lg:w-2/3 mx-auto",children:!I&&(null==z?void 0:null===(e=z.candidates)||void 0===e?void 0:e.map(function(e,t){return(0,a.jsx)(f,{onClick:function(){return!O&&q===S&&G(e)},isSelected:(null==B?void 0:B.name)===e.name,name:e.name,index:e.key,title:"Kandidat "+e.key,percentage:e.votes?e.votes/(null==z?void 0:z.totalVotes)*100:0},e.key)}))}),(0,a.jsxs)("div",{className:"text-center mt-10",children:[(null==C?void 0:null===(t=C.user)||void 0===t?void 0:t.email)!=(null==z?void 0:z.publisher)&&!O&&q===S&&(0,a.jsx)(v.Z,{onClick:function(){J()},text:"Kirim Vote Saya",size:"lg",isLoading:I}),O&&(0,a.jsx)("span",{className:"bg-zinc-100 py-2 px-3",children:"Kamu sudah memilih, dan tidak diperbolehkan untuk mengganti pilihan"}),(null==C?void 0:null===(n=C.user)||void 0===n?void 0:n.email)===(null==z?void 0:z.publisher)&&(0,a.jsx)("span",{className:"bg-zinc-100 py-2 px-3",children:"Pembuat vote tidak dapat melakukan voting"})]})]})]}):(0,a.jsx)(k.Z,{})}}},function(e){e.O(0,[885,959,875,338,774,888,179],function(){return e(e.s=4443)}),_N_E=e.O()}]);